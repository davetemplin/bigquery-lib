SELECT *, IF(expected=actual, "PASS", "FAIL") result FROM (
    SELECT url, expected, `bigquery-lib.udf.validate_url`(url) actual
    FROM UNNEST([
        STRUCT("http://foo.bar" AS url, TRUE AS expected),
        STRUCT("http://foo.bar/", TRUE),
        STRUCT("http://foo.bar.baz/", TRUE),
        STRUCT("http://foo.com/baz", TRUE),
        STRUCT("http://foo.com/baz/", TRUE),
        STRUCT("http://foo.com/blah_blah_(wikipedia)", TRUE),
        STRUCT("http://foo.com/blah_blah_(wikipedia)_(again)", TRUE),
        STRUCT("http://www.example.com/wpstyle/?p=364", TRUE),
        STRUCT("https://www.example.com/foo/?bar=baz&inga=42&quux", TRUE),
        STRUCT("http://✪df.ws/123", TRUE),
        STRUCT("http://userid:password@example.com:8080", TRUE),
        STRUCT("http://userid:password@example.com:8080/", TRUE),
        STRUCT("http://userid@example.com", TRUE),
        STRUCT("http://userid@example.com/", TRUE),
        STRUCT("http://userid@example.com:8080", TRUE),
        STRUCT("http://userid@example.com:8080/", TRUE),
        STRUCT("http://userid:password@example.com", TRUE),
        STRUCT("http://userid:password@example.com/", TRUE),
        STRUCT("http://142.42.1.1/", TRUE),
        STRUCT("http://142.42.1.1:8080/", TRUE),
        STRUCT("http://➡.ws/䨹", TRUE),
        STRUCT("http://⌘.ws", TRUE),
        STRUCT("http://⌘.ws/", TRUE),
        STRUCT("http://foo.com/blah_(wikipedia)#cite-1", TRUE),
        STRUCT("http://foo.com/blah_(wikipedia)_blah#cite-1", TRUE),
        STRUCT("http://foo.com/unicode_(✪)_in_parens", TRUE),
        STRUCT("http://foo.com/(something)?after=parens", TRUE),
        STRUCT("http://☺.damowmow.com/", TRUE),
        STRUCT("http://code.google.com/events/#&product=browser", TRUE),
        STRUCT("http://j.mp", TRUE),
        STRUCT("ftp://foo.bar/baz", TRUE),
        STRUCT("http://foo.bar/?q=Test%20URL-encoded%20stuff", TRUE),
        STRUCT("http://مثال.إختبار", TRUE),
        STRUCT("http://例子.测试", TRUE),
        STRUCT("http://उदाहरण.परीक्षा", TRUE),
        STRUCT("http://-.~_!$&'()*+,;=:%40:80%2f::::::@example.com", TRUE),
        STRUCT("http://1337.net", TRUE),
        STRUCT("http://a.b-c.de", TRUE),
        STRUCT("http://223.255.255.254", TRUE),
        STRUCT("https://foo_bar.example.com/", TRUE),
        STRUCT("http://foo.bar?baz", TRUE),
        STRUCT("http://foo.bar#baz", TRUE),
        STRUCT("http://foo.bar?baz#quux", TRUE),
        STRUCT("http://foo.bar#baz?quux", TRUE),
        STRUCT("http://a.b--c.de/", TRUE),
        STRUCT("https://xn--b1afblufcdrdkmek.xn--p1ai/", TRUE),
        STRUCT("http://xn----8sbb3akwgfdmdif5dxc.xn--p1ai/риджид-каталог-пилы-свёрла-для-сверления.htm", TRUE),
        STRUCT("http://foo.bar?baz quux", TRUE),
        STRUCT("http://foo.bar#baz quux", TRUE),
        STRUCT("http://foo.bar/baz quux", TRUE),
        STRUCT("http://foo_bar.baz/", TRUE),
        STRUCT("http://foo.bar_baz.quux/", TRUE),
        STRUCT("http://foo_bar.foo_baz.quux/", TRUE),
        STRUCT("http://", FALSE),
        STRUCT("http://.", FALSE),
        STRUCT("http://..", FALSE),
        STRUCT("http://../", FALSE),
        STRUCT("http://?", FALSE),
        STRUCT("http://??", FALSE),
        STRUCT("http://??/", FALSE),
        STRUCT("http://#", FALSE),
        STRUCT("http://##", FALSE),
        STRUCT("http://##/", FALSE),
        STRUCT("//", FALSE),
        STRUCT("//a", FALSE),
        STRUCT("///a", FALSE),
        STRUCT("///", FALSE),
        STRUCT("http:///a", FALSE),
        STRUCT("foo.com", FALSE),
        STRUCT("rdar://1234", FALSE),
        STRUCT("h://test", FALSE),
        STRUCT("http:// shouldfail.com", FALSE),
        STRUCT(":// should fail", FALSE),
        STRUCT("ftps://foo.bar/", FALSE),
        STRUCT("http://-error-.invalid/", FALSE),
        STRUCT("http://-a.b.co", FALSE),
        STRUCT("http://a.b-.co", FALSE),
        STRUCT("http://0.0.0.0", FALSE),
        STRUCT("http://10.1.1.0", FALSE),
        STRUCT("http://10.1.1.255", FALSE), -- why do some 10. pass and other like this one fail?
        STRUCT("http://224.1.1.1", FALSE),
        STRUCT("http://1.1.1.1.1", FALSE),
        STRUCT("http://123.123.123", FALSE), -- fails because we're now allowing numbers in top-level domain
        STRUCT("http://3628126748", FALSE),
        STRUCT("http://.www.foo.bar/", FALSE),
        STRUCT("http://www.foo.bar./", FALSE),
        STRUCT("http://.www.foo.bar./", FALSE),
        STRUCT("http://10.1.1.1", FALSE), -- why do some 10. pass and other like this one fail?
        STRUCT("http://10.1.1.254", FALSE), -- why do some 10. pass and other like this one fail?
        STRUCT("http://foo.bar.baz_quux/", FALSE),
        STRUCT("https://{foo}.bar.baz/", FALSE),
        STRUCT("http://http://foo.bar", FALSE)
    ])
);